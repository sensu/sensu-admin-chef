# Graphite Apache Virtual Host
#
# Generated by Chef
<VirtualHost *:<%= @http_port -%>>
  ServerName <%= @host %>
            
  Redirect / https://<%= @hostip %>/
</VirtualHost>

<VirtualHost *:<%= @https_port -%>>
  ServerName <%= @host %>
            
  AddDefaultCharset utf-8
  DocumentRoot <%= @base_path -%>/website/current/public

  ProxyRequests Off
  ProxyPreserveHost On

  ProxyPass /assets/ !
  ProxyPass / http://localhost:<%= @backend_port -%>/
  ProxyPassReverse / http://localhost:<%= @backend_port -%>/

  Alias /assets/ "<%= @base_path -%>/website/current/public/assets/"

  SSLEngine On
  SSLCertificateFile <%= @base_path -%>/server-cert.pem
  SSLCertificateKeyFile <%= @base_path -%>/server-key.pem
  SSLCACertificateFile <%= @base_path -%>/server-cacert.pem

  CustomLog /var/log/apache2/sensu-admin-access.log combined
  ErrorLog /var/log/apache2/sensu-admin-error.log
</VirtualHost>

